<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>truyentranhgay 18+</title>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:white;
    color:black;
    transition:0.3s;
}
.dark{
    background:#111;
    color:white;
}
header{
    background:#e91e63;
    color:white;
    padding:15px;
    display:flex;
    justify-content:space-between;
}
button{
    padding:6px 12px;
    cursor:pointer;
}
.container{
    padding:20px;
}
.card{
    border:1px solid #ccc;
    padding:15px;
    margin-bottom:15px;
}
.hidden{
    display:none;
}
select,input,textarea{
    width:100%;
    margin-bottom:10px;
    padding:8px;
}
.comment-box{
    margin-top:10px;
    border-top:1px solid gray;
    padding-top:10px;
}
</style>
</head>
<body>

<header>
    <h2>truyentranhgay 18+</h2>
    <div>
        <button onclick="toggleTheme()">ğŸŒ™ / â˜€ï¸</button>
        <button onclick="showLogin()">ÄÄƒng nháº­p</button>
        <button onclick="showUpload()">ÄÄƒng tÃ¡c pháº©m</button>
    </div>
</header>

<div class="container">

<h3>ğŸ“š PhÃ¢n loáº¡i</h3>
<select id="filterType" onchange="loadPosts()">
    <option value="all">Táº¥t cáº£</option>
    <option value="text">Truyá»‡n chá»¯</option>
    <option value="comic">Truyá»‡n tranh</option>
    <option value="image">áº¢nh tá»± do</option>
</select>

<div id="posts"></div>

</div>

<!-- LOGIN -->
<div id="loginBox" class="container hidden">
<h3>ÄÄƒng nháº­p</h3>
<input id="nickname" placeholder="Biá»‡t danh">
<button onclick="login()">XÃ¡c nháº­n</button>
</div>

<!-- UPLOAD -->
<div id="uploadBox" class="container hidden">
<h3>ÄÄƒng tÃ¡c pháº©m</h3>

<select id="type">
    <option value="text">Truyá»‡n chá»¯</option>
    <option value="comic">Truyá»‡n tranh</option>
    <option value="image">áº¢nh tá»± do</option>
</select>

<input id="title" placeholder="TiÃªu Ä‘á»">
<input id="country" placeholder="Quá»‘c gia">
<input id="language" placeholder="NgÃ´n ngá»¯ gá»‘c">
<input id="genre" placeholder="Thá»ƒ loáº¡i">
<select id="translated">
    <option value="CÃ³ dá»‹ch">CÃ³ dá»‹ch</option>
    <option value="ChÆ°a dá»‹ch">ChÆ°a dá»‹ch</option>
</select>

<textarea id="content" placeholder="Ná»™i dung hoáº·c link áº£nh"></textarea>

<button onclick="upload()">ÄÄƒng</button>
</div>

<script>

let currentUser = localStorage.getItem("user");

function toggleTheme(){
    document.body.classList.toggle("dark");
}

function showLogin(){
    document.getElementById("loginBox").classList.toggle("hidden");
}

function showUpload(){
    if(!currentUser){
        alert("Báº¡n pháº£i Ä‘Äƒng nháº­p Ä‘á»ƒ Ä‘Äƒng tÃ¡c pháº©m!");
        return;
    }
    document.getElementById("uploadBox").classList.toggle("hidden");
}

function login(){
    let name = document.getElementById("nickname").value;
    if(name){
        localStorage.setItem("user", name);
        currentUser = name;
        alert("ÄÄƒng nháº­p thÃ nh cÃ´ng vá»›i biá»‡t danh: " + name);
    }
}

function upload(){
    let post = {
        type:document.getElementById("type").value,
        title:document.getElementById("title").value,
        country:document.getElementById("country").value,
        language:document.getElementById("language").value,
        genre:document.getElementById("genre").value,
        translated:document.getElementById("translated").value,
        content:document.getElementById("content").value,
        author:currentUser,
        comments:[]
    };

    let posts = JSON.parse(localStorage.getItem("posts") || "[]");
    posts.push(post);
    localStorage.setItem("posts", JSON.stringify(posts));
    alert("ÄÄƒng thÃ nh cÃ´ng!");
    loadPosts();
}

function loadPosts(){
    let filter = document.getElementById("filterType").value;
    let posts = JSON.parse(localStorage.getItem("posts") || "[]");
    let container = document.getElementById("posts");
    container.innerHTML = "";

    posts.forEach((p,index)=>{
        if(filter !== "all" && p.type !== filter) return;

        let div = document.createElement("div");
        div.className="card";
        div.innerHTML=`
            <h3>${p.title}</h3>
            <p><b>TÃ¡c giáº£:</b> ${p.author}</p>
            <p><b>Loáº¡i:</b> ${p.type}</p>
            <p><b>Thá»ƒ loáº¡i:</b> ${p.genre}</p>
            <p><b>Quá»‘c gia:</b> ${p.country}</p>
            <p><b>NgÃ´n ngá»¯:</b> ${p.language}</p>
            <p><b>TÃ¬nh tráº¡ng dá»‹ch:</b> ${p.translated}</p>
            <hr>
            <p>${p.content}</p>
            <div class="comment-box">
                <h4>BÃ¬nh luáº­n</h4>
                ${renderComments(p,index)}
            </div>
        `;
        container.appendChild(div);
    });
}

function renderComments(post,index){
    let html="";
    post.comments.forEach(c=>{
        html += `<p><b>${c.user}:</b> ${c.text} 
        <button onclick="translateComment('${c.text}')">Dá»‹ch</button></p>`;
    });

    if(currentUser){
        html += `
        <input id="comment${index}" placeholder="Viáº¿t bÃ¬nh luáº­n">
        <button onclick="addComment(${index})">Gá»­i</button>
        `;
    } else {
        html += "<p>ÄÄƒng nháº­p Ä‘á»ƒ bÃ¬nh luáº­n</p>";
    }

    return html;
}

function addComment(index){
    let posts = JSON.parse(localStorage.getItem("posts"));
    let text = document.getElementById("comment"+index).value;
    posts[index].comments.push({user:currentUser,text:text});
    localStorage.setItem("posts", JSON.stringify(posts));
    loadPosts();
}

function translateComment(text){
    alert("Giáº£ láº­p dá»‹ch: " + text);
}

loadPosts();

</script>

</body>
</html>
